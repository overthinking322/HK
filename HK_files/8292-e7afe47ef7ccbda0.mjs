(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["8292"],{169166:function(e,t,n){n.d(t,{Z:()=>a});let a=(0,n(667294).createContext)(null)},506807:function(e,t,n){n.d(t,{Z:()=>a});let a=(0,n(667294).createContext)(null)},495839:function(e,t,n){n.d(t,{Z:()=>k});var a=n(667294),i=n(970414),r=n(687412),o=n(774303),s=n(705460),l=n(426035),c=n(830031),u=n(197298),d=n(381571),p=n(217472),m=n(780657),g=n(139876),_=n(87980);let f=e=>{let t=performance.getEntriesByType("resource").filter(e=>e.name.includes("i.pinimg")).reduce((e,t)=>{let n=t.name.replace(".jpg","").split("/");return{[n[n.length-1]]:{downloadSize:t.name.split("/")[3].split("x")[0]},...e}},{});[...Array.from(document.getElementsByTagName("img")).map(e=>{let n=e.src.replace(".jpg","").split("/"),a=n[n.length-1];if(t[a]){let n=_.rZ(e)?.width||1,i=t[a].downloadSize;return{fileName:a,renderedSize:n,downloadedSize:i,ratio:i/n}}return{fileName:a,renderedSize:1,downloadedSize:1,ratio:1}}),...Array.from(document.querySelectorAll('div[role="img"]')).map(e=>{let n=e.style.backgroundImage.split('"')[1].replace(".jpg","").split("/"),a=n[n.length-1];if(t[a]&&e instanceof HTMLDivElement){let n=_.rZ(e)?.width||1,i=t[a].downloadSize;return{fileName:a,renderedSize:n,downloadedSize:i,ratio:i/n}}return{fileName:a,renderedSize:1,downloadedSize:1,ratio:1}})].forEach(t=>{let{ratio:n,fileName:a,downloadedSize:i}=t;t.ratio>1.05&&(0,s.A9)(`checkImageRatio.${e}`,{count:Math.round(10*n)/10,tags:{fileName:`${i}_${a}`}})})};var y=n(240083),w=n(296264),T=n(774838);let A=(e,t)=>{let n=(0,a.useRef)(t);return{getState:()=>n.current,dispatch:t=>{n.current=e(n.current,t)}}};var E=n(178355),S=n(767415),I=n(785893);let h=["initial_app_load","client_route_push"],M=(0,o.XV)("PwtSurface"),v="NavigationComplete",N="VisuallyComplete",C=(e,t,n,a)=>{let{metricConfig:{metricId:i,pwtStaticContext:r,annotateExperiments:o},annotations:s,binaryAnnotations:l,constraintMap:c,startTime:m,imageTimings:g,isSampled:_,spans:f,traceId:y}=e,w=(0,u.N)({reason:t,annotateExperiments:o,annotations:s,binaryAnnotations:l,constraintMap:c,endTime:n,imageTimings:g,metricId:i,pwtStaticContext:r,startTime:m,traceId:y,spans:f});_&&!a&&(0,p.Z)({metricId:i,pwtStaticContext:r,result:w,annotateExperiments:o?["web_perf_logger_v4",...o]:["web_perf_logger_v4"]}),(0,d._T)()},b=(e,t,n)=>{let{metricConfig:{metricId:a,pwtStaticContext:i,annotateExperiments:o},annotations:c,binaryAnnotations:m,constraintMap:g,startTime:_,imageTimings:y,isSampled:w,spans:T,traceId:A}=e;(0,l.L8)(`Report_PWT_Complete_${(0,r.KJ)(a)}`,_,t);let E=(0,u.W)({annotateExperiments:[...o??[],"web_perf_logger_v4"],annotations:c,binaryAnnotations:m,constraintMap:g,endTime:t,imageTimings:y,metricId:a,pwtStaticContext:i,startTime:_,traceId:A,spans:T});w&&!n&&(0,p.Z)({metricId:a,pwtStaticContext:i,result:E,annotateExperiments:o?["web_perf_logger_v4",...o]:["web_perf_logger_v4"]});try{f(String(E.binaryAnnotationMap["metricId.surface"].value))}catch(e){(0,s.H)("image_ratio_check_error",{error:e})}return(0,d._T)(),{...e,result:E,status:"DONE"}},L=(e,t)=>{if(e.metricConfig.constraints.every(t=>e.constraintMap[t])){let n=Math.max(...e.metricConfig.constraints.map(t=>e.constraintMap[t]));return b(e,n,t)}return M(`Remaining constraints: ${e.metricConfig.constraints.filter(t=>!e.constraintMap[t]).join(", ")}`),e},R=(e,t)=>{let{constraint:n,time:a,disablePWTLogging:i}=t,o=(0,r.KJ)(e.metricConfig.metricId);return w.Z?e.metricConfig.constraints.find(e=>e===n)?e.constraintMap[n]?(M(`constraint "${n}" is already complete.`),(0,s.H)("duplicated_constraint_complete",{constraint:n,action:o}),e):(M(`marking constraint "${n}" as complete ${a||performance.now()}`),a?(0,l.ZP)(`constraint_${n}_is_complete`,a):(0,l.ZP)(`constraint_${n}_is_complete`),L({...e,constraintMap:{...e.constraintMap,[n]:a||w.Z.now()}},i)):(M(`marked constraint "${n}" is not a required constraint.`),e):((0,s.H)("missing_window_performance",{action:o}),e)},Z=(e,t)=>{if(!w.Z){let t=(0,r.KJ)(e.metricConfig.metricId);(0,s.H)("missing_window_performance",{action:t})}M(`removing constraint "${t}"`);let n=e.metricConfig.constraints.filter(e=>e!==t),{[t]:a,...i}=e.constraintMap;return L({...e,constraintMap:i,metricConfig:{...e.metricConfig,constraints:n}})},O=(e,t)=>{if(!w.Z){let t=(0,r.KJ)(e.metricConfig.metricId);(0,s.H)("missing_window_performance",{action:t})}M(`updating pwt segment to "${t}"`);let n={...e.metricConfig.metricId,segment:t};return{...e,metricConfig:{...e.metricConfig,metricId:n}}},H=(e,t)=>{let{metricConfig:n,startTime:a,isSampled:i,disablePWTLogging:o}=t;if(o||"TIMING"!==e.status||a===e.startTime||C(e,"routeUpdatedOnSameSurface",w.Z?.now()||0,o),!n)return{status:"DISABLED",metricConfig:null};let l=(0,r.KJ)(n.metricId);if("TIMING"===e.status&&e.startTime===a&&e.constraintMap[v])return(0,s.H)("duplicated_init_route_action",{action:l}),e;if(!o){let e=(0,E.H)();(0,s.A9)(`handler.${l}`,{tags:{handler:e}});let t=void 0!==n.metricId.isAuthenticated&&{tags:{isAuth:n.metricId.isAuthenticated}}||void 0;"Other"===n.pwtStaticContext.browserName&&!1===n.metricId.isAuthenticated&&"initial_app_load"===n.metricId.navigationType?((0,s.A9)(`TIMING.${l}`,{tags:{userAgent:window?.navigator?.userAgent}}),(0,s.A9)(`TIMING.sampled.${l}`,{tags:{userAgent:window?.navigator?.userAgent},sampleRate:.03})):((0,s.A9)(`TIMING.${l}`),(0,s.A9)(`TIMING.sampled.${l}`,{sampleRate:.03})),(0,p.C)({resultLog:`TIMING.${l}`,annotateExperiments:n.annotateExperiments||[],getExperimentGroup:n.pwtStaticContext.getExperimentGroup,options:t})}return R({traceId:(0,d.vc)()||(0,d.ZP)("initial_app_load"===n.metricId.navigationType,n.pwtStaticContext.serverData?.trace_id),status:"TIMING",metricConfig:n,startTime:a,constraintMap:{},annotations:{},binaryAnnotations:{},imageTimings:[],isSampled:i,spans:[]},{constraint:v,disablePWTLogging:o})},$=(e,t)=>{if(M("dispatch action",t),"INIT_ROUTE"===t.type)return H(e,t.payload);if("TIMING"!==e.status)return M(`ignoring action due to invalid state ${e.status}`,t),e;switch(t.type){case"ABORT":C(e,t.reason,w.Z?.now()||0);let n={type:"ABORT",reason:t.reason};return{...e,status:"DONE",result:n};case"ANNOTATE":let{name:a}=t.payload;if(!w.Z)return e;let i=w.Z.now();return M(`adding annotation {${a}: ${i}}`),{...e,annotations:{...e.annotations,[a]:i}};case"BINARY_ANNOTATE":let{name:o,value:l,annotationType:c}=t.payload;return M(`adding binary annotation {${o}: ${l}}`),{...e,binaryAnnotations:{...e.binaryAnnotations,[o]:{value:l,type:c}}};case"MARK_CONSTRAINT_COMPLETE":return R(e,t.payload);case"REMOVE_CONSTRAINT":return Z(e,t.payload);case"SET_SEGMENT":return O(e,t.payload);case"SET_VISUALLY_COMPLETE_RESULT":{let{payload:{imageTimings:n}}=t;if(0===n.length)return C(e,"visuallyComplete_noImages",w.Z?.now()||0),{...e,status:"DONE",result:{type:"ABORT",reason:"visuallyComplete_noImages"}};let a=Math.max(...n.map(e=>e.responseEnd||0));return R({...e,imageTimings:n},{constraint:N,time:a})}case"ADD_SUBSPAN":let{startTime:u}=e,{payload:{name:d,startTime:p,endTime:m,annotations:g,binaryAnnotations:_,parentId:f}}=t;return{...e,spans:[...e.spans,{name:d,id:(0,y.Z)(),startTime:p||u,endTime:m,annotationMap:{...g},binaryAnnotationMap:{..._},parentId:f}]};case"START_SUBSPAN":return{...e,spans:[...e.spans,{name:t.payload.name,id:(0,y.Z)(),startTime:w.Z?w.Z.now():0,endTime:1/0,annotationMap:{...t.payload.annotations},binaryAnnotationMap:{...t.payload.binaryAnnotations},parentId:t.payload.parentId}]};case"STOP_SUBSPAN":let T=e.spans.findIndex(e=>e.name===t.payload.name);return T>-1?(e.spans[T].endTime=w.Z?w.Z.now():0,t.payload.annotations&&(e.spans[T].annotationMap={...e.spans[T].annotationMap,...t.payload.annotations}),t.payload.binaryAnnotations&&(e.spans[T].binaryAnnotationMap={...e.spans[T].binaryAnnotationMap,...t.payload.binaryAnnotations})):(0,s.H)("invalid_subspan_stop_name",{name:t.payload.name}),e;default:let A=(0,r.KJ)(e.metricConfig.metricId);return(0,s.H)("invalid_pwt_surface_action",{action:A}),e}},P=e=>{if(!e)return"initial_app_load";switch(e.action){case"PUSH":return"client_route_push";case"REPLACE":return"client_route_replace";default:return null}},B=new Set,x=({surface:e,constraints:t,segment:n,measureGridVisuallyComplete:r,annotateExperiments:o,customEnabledNavigationTypes:s,navigationInfo:{clientNavigation:l,navigationType:c},sampleRate:u})=>{let d=(0,a.useRef)("NOT_SET"),p=(0,g.Z)(),{getState:m,dispatch:_}=A($,{status:"DISABLED",metricConfig:null}),f=(0,T.B)();if(d.current!==l&&(d.current=l,p)){let{isAuthenticated:a}=p,i=e&&c&&(s||h).includes(c)?{metricId:{type:"surface",surface:e,navigationType:c,isAuthenticated:a,segment:n},annotateExperiments:o,constraints:[v,...t||[],...r?[N]:[]],pwtStaticContext:p}:null;(0,S.nP)("webapp.pwt_surface.init_route",{tags:{surface:e,navigationType:c,isAuthenticated:a}});let d=!B.has(l);_({type:"INIT_ROUTE",payload:{metricConfig:i,startTime:l?l.time:0,isSampled:!u||Math.random()<u,disablePWTLogging:!d}}),d&&B.add(l)}let y=m();if((0,a.useEffect)(()=>()=>{B.delete(l)},[l]),(0,a.useEffect)(()=>{let e=e=>{_({type:"ABORT",reason:e})};i.Z.onSessionPause(e);let t=window.innerHeight,n=window.innerWidth,a=()=>{let e=Math.abs(window.innerHeight-t),i=Math.abs(window.innerWidth-n),r=window.innerHeight!==t,o=window.innerWidth!==n,s={handler:(0,E.H)(),deviceType:p?.deviceType??"unknown",isAuthenticated:p?.isAuthenticated??"unknown",platform:f.userAgent.platform??"unknown"};if((0,S.nP)("webapp.PwtLogger.handleResize",{sampleRate:1,tags:{...s,heightChanged:r,widthChanged:o}}),r&&(0,S.S0)("webapp.PwtLogger.resizeHeightDelta",e,{sampleRate:1,tags:s}),o&&(0,S.S0)("webapp.PwtLogger.resizeWidthDelta",i,{sampleRate:1,tags:s}),window.removeEventListener("resize",a),p?.deviceType==="phone"&&(!o&&r&&e<=150||!r&&!o)||p?.deviceType==="desktop"&&!r&&!o){(0,S.nP)("webapp.PwtLogger.skipResizeAbort",{sampleRate:1,tags:{...s,heightChanged:r,widthChanged:o}});return}_({type:"ABORT",reason:"windowResized"})};return window.addEventListener("resize",a),()=>{let t=m();M("handling unmount",t),"TIMING"===t.status&&C(t,"unmount",w.Z?.now()||0),i.Z.removePauseListener(e),window.removeEventListener("resize",a)}},[]),"TIMING"!==y.status||!y.constraintMap[v])return{state:y,context:null};let{startTime:I,metricConfig:b}=y;return{state:y,context:{abort:e=>_({type:"ABORT",reason:e}),addAnnotation:e=>_({type:"ANNOTATE",payload:{name:e}}),addBinaryAnnotation:(e,t,n)=>_({type:"BINARY_ANNOTATE",payload:{name:e,value:t,annotationType:n}}),addSubspan:(e,t,n,a={},i={},r=null)=>_({type:"ADD_SUBSPAN",payload:{name:e,startTime:t,endTime:n,annotations:a,binaryAnnotations:i,parentId:r}}),getId:()=>I,getMetricId:()=>b.metricId,markConstraintComplete:e=>_({type:"MARK_CONSTRAINT_COMPLETE",payload:{constraint:e,time:w.Z?w.Z.now():0}}),removeConstraint:e=>_({type:"REMOVE_CONSTRAINT",payload:e}),setSegment:e=>_({type:"SET_SEGMENT",payload:e}),setVisuallyCompleteResult:b.constraints.includes(N)?e=>_({type:"SET_VISUALLY_COMPLETE_RESULT",payload:e}):null,startSubspan:(e,t={},n={},a=null)=>_({type:"START_SUBSPAN",payload:{name:e,annotations:t,binaryAnnotations:n,parentId:a}}),stopSubspan:(e,t={},n={},a=null)=>_({type:"STOP_SUBSPAN",payload:{name:e,annotations:t,binaryAnnotations:n,parentId:a}})}}},D=()=>{let e=(0,c.E)(),t=!!e;(0,a.useEffect)(()=>{if(t){let t=e?.getMetricId(),n=t?(0,r.KJ)(t):null;(0,s.H)("nested_pwt_surface",{action:n})}},[t])};function k({children:e,...t}){let n=(0,m.Z)(),a=P(n),i=t.measureGridVisuallyComplete?["web_masonry_v2_auth","web_masonry_v2_unauth","web_fluid_grid_desktop_auth","web_fluid_grid_desktop_unauth"]:[],r=[...t.annotateExperiments??[],...i,"web_perf_logger_v4"],{context:o}=x({...t,annotateExperiments:r,navigationInfo:{navigationType:a,clientNavigation:n}});return D(),(0,I.jsx)(c.S,{value:o,children:e})}},830031:function(e,t,n){n.d(t,{E:()=>i,S:()=>a});let{Provider:a,useMaybeHook:i}=(0,n(213491).Z)("pwtSurfaceContext")},87980:function(e,t,n){n.d(t,{F9:()=>p,LM:()=>c,VZ:()=>r,cQ:()=>m,rZ:()=>o});var a=n(397345),i=n(705460);let r=()=>"number"==typeof window.innerHeight&&"number"==typeof window.pageYOffset&&!!document.querySelector&&!!document.querySelectorAll,o=e=>e instanceof HTMLDivElement||e instanceof HTMLVideoElement?e.getBoundingClientRect():e.parentElement instanceof HTMLElement?e.parentElement.getBoundingClientRect():null,s=({top:e,height:t},{foldY:n,pageYOffset:a})=>{let i=e+a;if(i>=n)return!1;let r=Math.min(t,n-i);return r>.5*t||r>.2*n},l=e=>{if(e instanceof HTMLImageElement)return e.src;if(e instanceof HTMLVideoElement)return e.attributes.poster.value;let t=((e.style||{}).backgroundImage||"").match(/^url\(["'](.*)["']\)$/);return t&&t[1]||null},c=()=>document.querySelector?document.querySelectorAll(a.wc).length:((0,i.H)("missing_document_query_selector"),0),u=()=>{if(!document.querySelector)return(0,i.H)("missing_document_query_selector"),null;let e=document.querySelectorAll(a.wc);return e[e.length-1]||null},d=(e,t)=>{let n=o(e);if(!n)return(0,i.H)("missing_client_rect"),!1;if(n.width<70&&n.height<70){if(e instanceof HTMLImageElement)return!1;let t=l(e);if(t?.endsWith("svg"))return!1}return s(n,t)},p=()=>{let e=u();if(!e)return!1;let t=window.innerHeight||0,n=window.pageYOffset||0;return e.getBoundingClientRect().top+n>=t},m=(e,t,n)=>{if(!document.querySelector)return(0,i.H)("missing_document_query_selector"),[];let r={foldY:window.innerHeight||0,pageYOffset:window.pageYOffset||0},o=[a.Wf,...e?[a.fF]:[],...t?[a.$N]:[]].join(","),s=[...document.querySelectorAll(o)];if(n){let e=[...document.querySelectorAll('div[data-test-id="board-section"]')],t=e=>{let n=[...e.children];!n.length&&e.style.backgroundImage?s.push(e):n.length&&n.forEach(e=>{t(e)})};e.forEach(e=>{t(e)})}return s.reduce((e,n)=>{if((n instanceof HTMLImageElement||n instanceof HTMLDivElement||n instanceof HTMLVideoElement&&t)&&d(n,r)){let t=l(n);if(t){let a=(t||"").replace(/.*\//,"");return e.concat([{element:n,fileName:a}])}}return e},[])}},397345:function(e,t,n){n.d(t,{$N:()=>l,Kb:()=>a,Wf:()=>o,fF:()=>s,wc:()=>r});let a="pwt-grid-item",i=['div[data-grid-item="true"]',"div.Grid__Item",`div[data-test-id="${a}"]`],r=i.join(","),o=i.map(e=>`${e} img`).join(","),s=i.map(e=>`${e} div[style*=background-image]`).join(","),l=i.map(e=>`${e} video`).join(",")},780657:function(e,t,n){n.d(t,{Z:()=>r});var a=n(667294),i=n(169166);function r(){return(0,a.useContext)(i.Z)}},139876:function(e,t,n){n.d(t,{Z:()=>r});var a=n(667294),i=n(506807);function r(){return(0,a.useContext)(i.Z)}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/8292-e7afe47ef7ccbda0.mjs.map